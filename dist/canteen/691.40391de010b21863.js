"use strict";(self.webpackChunkcanteen=self.webpackChunkcanteen||[]).push([[691],{4691:($e,Z,s)=>{s.d(Z,{a:()=>Be});var O=s(8645),v=s(3620),d="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function f(n,o,t){var i=new XMLHttpRequest;i.open("GET",n),i.responseType="blob",i.onload=function(){h(i.response,o,t)},i.onerror=function(){console.error("could not download file")},i.send()}function x(n){var o=new XMLHttpRequest;o.open("HEAD",n,!1);try{o.send()}catch{}return o.status>=200&&o.status<=299}function u(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}}var C=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=d.saveAs||("object"!=typeof window||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!C?function(o,t,i){var r=d.URL||d.webkitURL,a=document.createElement("a");a.download=t=t||o.name||"download",a.rel="noopener","string"==typeof o?(a.href=o,a.origin!==location.origin?x(a.href)?f(o,t,i):u(a,a.target="_blank"):u(a)):(a.href=r.createObjectURL(o),setTimeout(function(){r.revokeObjectURL(a.href)},4e4),setTimeout(function(){u(a)},0))}:"msSaveOrOpenBlob"in navigator?function(o,t,i){if(t=t||o.name||"download","string"==typeof o)if(x(o))f(o,t,i);else{var r=document.createElement("a");r.href=o,r.target="_blank",setTimeout(function(){u(r)})}else navigator.msSaveOrOpenBlob(function D(n,o){return typeof o>"u"?o={autoBom:!1}:"object"!=typeof o&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob([String.fromCharCode(65279),n],{type:n.type}):n}(o,i),t)}:function(o,t,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof o)return f(o,t,i);var a="application/octet-stream"===o.type,c=/constructor/i.test(d.HTMLElement)||d.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&c||C)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var g=p.result;g=l?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=g:location=g,r=null},p.readAsDataURL(o)}else{var y=d.URL||d.webkitURL,T=y.createObjectURL(o);r?r.location=T:location.href=T,r=null,setTimeout(function(){y.revokeObjectURL(T)},4e4)}});d.saveAs=h.saveAs=h;var e=s(5879),N=s(5565),_=s(95),w=s(6100),A=s(2425),S=s(6805),M=s(3026),H=s(1896),b=s(6814),U=s(4819),m=s(9538),q=s(3566),P=s(4836);const Y=["dateRangeModal"];function I(n,o){1&n&&e._UZ(0,"app-loader")}function k(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Order Id"),e.qZA())}function J(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",39)(1,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.copyOrderId(a._id))}),e._uU(2),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t._id)}}function Q(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Date"),e.qZA())}function E(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.date," ")}}function R(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee ID "),e.qZA())}function B(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.emp_id," ")}}function $(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee Name "),e.qZA())}function z(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.fullName," ")}}function j(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Order Status "),e.qZA())}function F(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.order_status," ")}}function L(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Total Amount"),e.qZA())}function G(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.totalBalance," ")}}function K(n,o){1&n&&e._UZ(0,"tr",42)}function W(n,o){1&n&&e._UZ(0,"tr",43)}function X(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"h4",45),e._uU(2,"Select Date Range"),e.qZA(),e.TgZ(3,"i",46),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.dismiss("Cross click"))}),e.qZA()(),e.TgZ(4,"div",47)(5,"form",48,49),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onDateRangeSubmit())}),e.TgZ(7,"div",50)(8,"label",51),e._uU(9,"Start Date"),e.qZA(),e.TgZ(10,"input",52),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.startDate=r)})("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onStartDateChange())}),e.qZA()(),e.TgZ(11,"div",50)(12,"label",53),e._uU(13,"End Date"),e.qZA(),e.TgZ(14,"input",54),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.endDate=r)}),e.qZA()(),e.TgZ(15,"button",55),e._uU(16," Submit "),e.qZA()()()}if(2&n){const t=e.MAs(6),i=e.oxw(2);e.xp6(10),e.Q6J("ngModel",i.startDate),e.xp6(4),e.Q6J("ngModel",i.endDate)("min",i.startDate),e.xp6(1),e.Q6J("disabled",t.invalid)}}function V(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div")(7,"span"),e._uU(8," Order History "),e.qZA()(),e.TgZ(9,"div",8)(10,"button",9),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.openDateRangeModal())}),e._uU(11,"Download Excel"),e.qZA(),e.TgZ(12,"div",10)(13,"select",11),e.NdJ("change",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.onSelectChange(r))}),e.TgZ(14,"option",12),e._uU(15,"Order Status"),e.qZA(),e.TgZ(16,"option",13),e._uU(17,"confirm"),e.qZA(),e.TgZ(18,"option",14),e._uU(19,"pending"),e.qZA(),e.TgZ(20,"option",15),e._uU(21,"cancelled"),e.qZA()()(),e.TgZ(22,"div",16)(23,"input",17),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.searchName=r)})("keydown",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.searchDebounced())}),e.qZA(),e.TgZ(24,"label",18),e._UZ(25,"i",19),e.qZA()()()(),e.TgZ(26,"div",20)(27,"div",21),e.YNc(28,I,1,0,"app-loader",22),e.TgZ(29,"table",23),e.ynx(30,24),e.YNc(31,k,2,0,"th",25),e.YNc(32,J,3,1,"td",26),e.BQk(),e.ynx(33,27),e.YNc(34,Q,2,0,"th",25),e.YNc(35,E,2,1,"td",28),e.BQk(),e.ynx(36,29),e.YNc(37,R,2,0,"th",25),e.YNc(38,B,2,1,"td",28),e.BQk(),e.ynx(39,30),e.YNc(40,$,2,0,"th",25),e.YNc(41,z,2,1,"td",28),e.BQk(),e.ynx(42,31),e.YNc(43,j,2,0,"th",25),e.YNc(44,F,2,1,"td",28),e.BQk(),e.ynx(45,32),e.YNc(46,L,2,0,"th",25),e.YNc(47,G,2,1,"td",28),e.BQk(),e.YNc(48,K,1,0,"tr",33),e.YNc(49,W,1,0,"tr",34),e.qZA(),e.TgZ(50,"div",35)(51,"mat-paginator",36),e.NdJ("page",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.pagesChangedOrderHistory(r))}),e.qZA()()()()()()()(),e.YNc(52,X,17,4,"ng-template",null,37,e.W1O),e.Hsn(54),e.qZA()}if(2&n){const t=e.oxw();e.xp6(23),e.Q6J("ngModel",t.searchName),e.xp6(5),e.Q6J("ngIf",t.isLoadingOrderHistory),e.xp6(1),e.Q6J("dataSource",t.orderHistoryData),e.xp6(19),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(2),e.Q6J("length",t.totalItemsOrderHistory)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSizeOrderHistory)("pageIndex",t.currentPageOrderHistory)}}function ee(n,o){1&n&&e._UZ(0,"app-loader")}function te(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Order Id"),e.qZA())}function ne(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",39)(1,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.copyOrderId(a._id))}),e._uU(2),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t._id)}}function oe(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee ID "),e.qZA())}function ie(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.emp_id," ")}}function re(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee Name "),e.qZA())}function ae(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.fullName," ")}}function ce(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Item Info"),e.qZA())}function se(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t.item_name),e.xp6(2),e.hij(" ",t.quantity,"")}}function le(n,o){if(1&n&&(e.TgZ(0,"td",67)(1,"table",68),e.YNc(2,se,5,2,"tr",69),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ngForOf",t.order_rec)}}function de(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Price"),e.qZA())}function _e(n,o){if(1&n&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.price," ")}}function me(n,o){if(1&n&&(e.TgZ(0,"td",67)(1,"div",70),e.YNc(2,_e,2,1,"div",69),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ngForOf",t.order_rec)}}function pe(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Total Amount"),e.qZA())}function ge(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.totalBalance," ")}}function ue(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Date"),e.qZA())}function he(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.date," ")}}function fe(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Action"),e.qZA())}function Te(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",71)(1,"button",72),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.changeOrderStatus(a._id,"confirm"))}),e._uU(2," Confirm "),e.qZA(),e.TgZ(3,"button",73),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.changeOrderStatus(a._id,"cancelled"))}),e._uU(4," Reject "),e.qZA()()}}function xe(n,o){1&n&&e._UZ(0,"tr",42)}function Ce(n,o){1&n&&e._UZ(0,"tr",43)}function be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"section",56),e.YNc(1,ee,1,0,"app-loader",22),e.TgZ(2,"div",57)(3,"div",58)(4,"div",59)(5,"div",60)(6,"div",6)(7,"div",7)(8,"span"),e._uU(9," Pending Order's "),e.qZA()(),e.TgZ(10,"div",20)(11,"div",61)(12,"table",23),e.ynx(13,24),e.YNc(14,te,2,0,"th",25),e.YNc(15,ne,3,1,"td",26),e.BQk(),e.ynx(16,29),e.YNc(17,oe,2,0,"th",25),e.YNc(18,ie,2,1,"td",28),e.BQk(),e.ynx(19,30),e.YNc(20,re,2,0,"th",25),e.YNc(21,ae,2,1,"td",28),e.BQk(),e.ynx(22,62),e.YNc(23,ce,2,0,"th",25),e.YNc(24,le,3,1,"td",63),e.BQk(),e.ynx(25,64),e.YNc(26,de,2,0,"th",25),e.YNc(27,me,3,1,"td",63),e.BQk(),e.ynx(28,32),e.YNc(29,pe,2,0,"th",25),e.YNc(30,ge,2,1,"td",28),e.BQk(),e.ynx(31,27),e.YNc(32,ue,2,0,"th",25),e.YNc(33,he,2,1,"td",28),e.BQk(),e.ynx(34,65),e.YNc(35,fe,2,0,"th",25),e.YNc(36,Te,5,0,"td",66),e.BQk(),e.YNc(37,xe,1,0,"tr",33),e.YNc(38,Ce,1,0,"tr",34),e.qZA(),e.TgZ(39,"div",35)(40,"mat-paginator",36),e.NdJ("page",function(r){e.CHM(t);const a=e.oxw();return e.KtG(a.pageChangedPendingOrder(r))}),e.qZA()()()()()()()()(),e.Hsn(41,1),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isLoading),e.xp6(11),e.Q6J("dataSource",t.pagedEmployeeData),e.xp6(25),e.Q6J("matHeaderRowDef",t.displayedColumnsPendingOrders),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumnsPendingOrders),e.xp6(2),e.Q6J("length",t.totalItemsPendingOrder)("pageSizeOptions",t.pageSizeOptionsPendingOrder)("pageSize",t.pageSizePendingOrder)("pageIndex",t.currentPagePendingOrder)}}function ye(n,o){1&n&&e._UZ(0,"app-loader")}function Ze(n,o){1&n&&(e.TgZ(0,"div"),e._uU(1," No items found matching the search criteria. "),e.qZA())}function Oe(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Order Id"),e.qZA())}function ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",39)(1,"span",40),e.NdJ("click",function(){const a=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.copyOrderId(a._id))}),e._uU(2),e.qZA()()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t._id)}}function De(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1,"Date"),e.qZA())}function Ne(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.date," ")}}function we(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee ID "),e.qZA())}function Ae(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.emp_id," ")}}function Se(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Employee Name "),e.qZA())}function Me(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.fullName," ")}}function He(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Order Status "),e.qZA())}function Ue(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.order_status," ")}}function qe(n,o){1&n&&(e.TgZ(0,"th",38),e._uU(1," Total Amount"),e.qZA())}function Pe(n,o){if(1&n&&(e.TgZ(0,"td",41),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.hij(" ",t.totalBalance," ")}}function Ye(n,o){1&n&&e._UZ(0,"tr",42)}function Ie(n,o){1&n&&e._UZ(0,"tr",43)}function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"table",23),e.ynx(1,24),e.YNc(2,Oe,2,0,"th",25),e.YNc(3,ve,3,1,"td",26),e.BQk(),e.ynx(4,27),e.YNc(5,De,2,0,"th",25),e.YNc(6,Ne,2,1,"td",28),e.BQk(),e.ynx(7,29),e.YNc(8,we,2,0,"th",25),e.YNc(9,Ae,2,1,"td",28),e.BQk(),e.ynx(10,30),e.YNc(11,Se,2,0,"th",25),e.YNc(12,Me,2,1,"td",28),e.BQk(),e.ynx(13,31),e.YNc(14,He,2,0,"th",25),e.YNc(15,Ue,2,1,"td",28),e.BQk(),e.ynx(16,32),e.YNc(17,qe,2,0,"th",25),e.YNc(18,Pe,2,1,"td",28),e.BQk(),e.YNc(19,Ye,1,0,"tr",33),e.YNc(20,Ie,1,0,"tr",34),e.qZA(),e.TgZ(21,"div",35)(22,"mat-paginator",36),e.NdJ("page",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.pagesChangedOrderHistory(r))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.Q6J("dataSource",t.orderHistoryData),e.xp6(19),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns),e.xp6(2),e.Q6J("length",t.totalItemsOrderHistory)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSizeOrderHistory)("pageIndex",t.currentPageOrderHistory)}}function Je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",44)(1,"h4",45),e._uU(2,"Select Date Range"),e.qZA(),e.TgZ(3,"i",46),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.dismiss("Cross click"))}),e.qZA()(),e.TgZ(4,"div",47)(5,"form",48,49),e.NdJ("ngSubmit",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onDateRangeSubmit())}),e.TgZ(7,"div",50)(8,"label",51),e._uU(9,"Start Date"),e.qZA(),e.TgZ(10,"input",52),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.startDate=r)})("change",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onStartDateChange())}),e.qZA()(),e.TgZ(11,"div",50)(12,"label",53),e._uU(13,"End Date"),e.qZA(),e.TgZ(14,"input",54),e.NdJ("ngModelChange",function(r){e.CHM(t);const a=e.oxw(2);return e.KtG(a.endDate=r)}),e.qZA()(),e.TgZ(15,"button",55),e._uU(16," Submit "),e.qZA()()()}if(2&n){const t=e.MAs(6),i=e.oxw(2);e.xp6(10),e.Q6J("ngModel",i.startDate),e.xp6(4),e.Q6J("ngModel",i.endDate)("min",i.startDate),e.xp6(1),e.Q6J("disabled",t.invalid)}}function Qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"section",2)(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"button",9),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.openDateRangeModal())}),e._uU(8,"Download Excel"),e.qZA()()(),e.TgZ(9,"div",20)(10,"div",61),e.YNc(11,ye,1,0,"app-loader",22),e.YNc(12,Ze,2,0,"div",74),e.YNc(13,ke,23,7,"ng-template",null,75,e.W1O),e.qZA()()()()()(),e.YNc(15,Je,17,4,"ng-template",null,37,e.W1O),e.Hsn(17,2),e.qZA()}if(2&n){const t=e.MAs(14),i=e.oxw();e.xp6(11),e.Q6J("ngIf",i.isLoadingOrderHistory),e.xp6(1),e.Q6J("ngIf",0===i.orderHistoryData.length)("ngIfElse",t)}}const Ee=[[["",8,"orderhistory"]],[["",8,"pendingorder"]],[["",8,"userorderhistory"]]],Re=[".orderHistory",".pendingOrder",".userorderhistory"];let Be=(()=>{class n{constructor(t,i,r,a,c,l,p){this.http=t,this.formBuilder=i,this.orderService=r,this.toastr=a,this.clipboardService=c,this.modalService=l,this.route=p,this.orderHistory=!1,this.pendingOrder=!1,this.userorderhistory=!1,this.orderHistoryData=[],this.orders=[],this.pagedEmployeeData=[],this.currentPageOrderHistory=0,this.pageSizeOrderHistory=10,this.pageSizeOptionsOrderHistory=[5,10,25,100],this.currentPagePendingOrder=0,this.pageSizePendingOrder=10,this.pageSizeOptionsPendingOrder=[5,10,25,100],this.searchName="",this.searchNameSubject=new O.x,this.pageSizeOptions=[5,10,25,100],this.limit=this.pageSizeOrderHistory,this.isLoadingOrderHistory=!1,this.isLoading=!1,this.download="",this.dateInterval="",this.displayedColumns=["date","_id","emp_id","fullName","order_status","totalBalance"],this.displayedColumnsPendingOrders=["_id","emp_id","fullName","totalBalance","date","itemName","price","actions"],this.formData=[],this.startDate="",this.endDate=""}ngOnInit(){this.searchNameSubject.pipe((0,v.b)(500)).subscribe(()=>{this.getOrderHistory()}),this.getOrderHistory(),this.formB=this.formBuilder.group({startDate:[null],endDate:[null]}),this.orderSubscription=this.orderService.orders$.subscribe(t=>{this.orders=t,this.updatePagedData()}),this.pendingOrderList(),this.refreshInterval=setInterval(()=>{this.pendingOrderList()},3e4),this.route.queryParamMap.subscribe(t=>{const i=t.get("empId");this.searchName=i||this.searchName})}ngOnDestroy(){clearInterval(this.refreshInterval),this.orderSubscription.unsubscribe()}searchDebounced(){this.searchNameSubject.next("")}onSelectChange(t){const i=t.target.value;console.log("Selected value:",i),this.searchName=i,this.getOrderHistory()}getOrderHistory(){this.isLoadingOrderHistory=!0;const t=this.route.snapshot.queryParamMap.get("empId");this.searchName=t||this.searchName;const i=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).data.token:"";this.http.getOrderHistory(i,this.currentPageOrderHistory,this.searchName,this.limit,this.download,this.dateInterval).subscribe(a=>{this.orderHistoryData=a.data,this.totalItemsOrderHistory=a.totalRecords,console.log(a)},a=>{console.error("Error fetching order history:",a),this.toastr.error("Failed to fetch order history.")}).add(()=>{this.isLoadingOrderHistory=!1})}openDateRangeModal(){this.modalRef=this.modalService.open(this.dateRangeModal,{centered:!0,backdrop:"static"})}onDateRangeSubmit(){this.modalRef.close();const t=this.formatDate(this.startDate),i=this.formatDate(this.endDate);console.log("Formatted Start Date:",t),console.log("Formatted End Date:",i),this.getOrderHistoryWithDateRange(t,i)}getMinDate(){const t=new Date,i=t.getFullYear(),r=t.getMonth()+1;return`${i}-${r<10?"0"+r:r}-${t.getDate()}`}onStartDateChange(){const t=new Date(this.startDate),i=new Date(t);i.setDate(t.getDate()+1);const r=i.getFullYear(),a=i.getMonth()+1,c=i.getDate();this.endDate=`${r}-${a<10?"0"+a:a}-${c}`}formatDate(t){const i=t.split("-");return`${i[1]}-${i[2]}-${i[0]}`}getOrderHistoryWithDateRange(t,i){console.log("getOrderHistoryWithDateRange");try{this.isLoadingOrderHistory=!0;const r=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).data.token:"",a=`${t} to ${i}`;this.http.getOrderHistoryExecl(r,this.currentPageOrderHistory,this.searchName,this.pageSizeOrderHistory,"excel",a).subscribe(c=>{this.downloadExcel(c,`OrderHistory_${a}`)},c=>{console.error("Error fetching order history:",c),this.toastr.error("No items found matching the search criteria.")}).add(()=>{this.isLoadingOrderHistory=!1})}catch(r){console.log(r)}}downloadExcel(t,i){try{const r=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});h(r,`${i}.xlsx`)}catch(r){console.error("Error downloading file:",r)}}pagesChangedOrderHistory(t){this.currentPageOrderHistory=t.pageIndex,this.limit=t.pageSize,this.getOrderHistory()}pendingOrderList(){try{const t=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).data.token:"",i=this.currentPagePendingOrder+0,r=this.totalItemsPendingOrder||0,a=Math.ceil(r/this.pageSizePendingOrder);this.http.orderList(t,i,r,a,this.pageSizePendingOrder).subscribe(l=>{console.log(l,""),l&&l.data&&l.data.length>0&&this.orderService.setOrders(l.data),this.totalItemsPendingOrder=l.totalRecords})}catch(t){console.log(t)}}pageChangedPendingOrder(t){console.log("Page changed:",t),this.currentPagePendingOrder=t.pageIndex,this.pageSizePendingOrder=t.pageSize,this.pendingOrderList()}updatePagedData(){const t=this.currentPageOrderHistory*this.pageSizeOrderHistory;this.pagedEmployeeData=this.orders.slice(t,t+this.pageSizeOrderHistory)}changeOrderStatus(t,i){try{this.isLoading=!0;const r=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).data.token:"";this.http.orderStatus(r,i,t).subscribe(a=>{console.log(a,";;;;;;;"),this.orders=this.orders.filter(c=>c._id!==t),this.orderService.updateOrders(this.orders),this.toastr.info("Order Status Has Been Updated")},a=>{console.error(a),this.toastr.error("Error updating order status. Please try again.")},()=>{this.isLoading=!1})}catch(r){console.log(r)}}getItemNames(t){return t.order_rec.map(i=>i.item_name)}getQuantities(t){return t.order_rec.map(i=>i.quantity)}getPrices(t){return t.order_rec.map(i=>i.price)}copyOrderId(t){this.clipboardService.copyFromContent(t),this.toastr.success("Order ID copied to clipboard")}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(N.l),e.Y36(_.qu),e.Y36(w.Z),e.Y36(A._W),e.Y36(S.Yv),e.Y36(M.FF),e.Y36(H.gz))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["app-table"]],viewQuery:function(i,r){if(1&i&&e.Gf(Y,5),2&i){let a;e.iGM(a=e.CRH())&&(r.dateRangeModal=a.first)}},inputs:{orderHistory:"orderHistory",pendingOrder:"pendingOrder",userorderhistory:"userorderhistory"},ngContentSelectors:Re,decls:3,vars:3,consts:[["class","order-history-container pb-4",4,"ngIf"],["class","pendingOrder-container pb-4",4,"ngIf"],[1,"order-history-container","pb-4"],[1,"order-history-card"],[1,"row","my-4"],[1,"col-12"],[1,"card"],[1,"card-header","py-4","d-flex","flex-wrap","align-items-center","justify-content-between"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between"],[1,"btn","btn-outline-primary",3,"click"],[1,"dropdown"],["id","menuTitle","name","menuTitle","aria-label","Default select example",1,"form-control",3,"change"],["value","","disabled","","selected","",2,"display","none"],["value","confirm"],["value","pending"],["value","cancelled"],[1,"searchBar"],["type","text","placeholder","Search users...",1,"bg-transparent",3,"ngModel","ngModelChange","keydown"],["for","search-icon"],["aria-hidden","true",1,"fa","fa-search"],[1,"card-body"],[1,"table-responsive","w-100",2,"min-height","500px"],[4,"ngIf"],["mat-table","","matSort","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","_id",1,"mat-column-_id","mat-header-cell-orderId","mat-cell-orderId"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","mat-cell-orderId",4,"matCellDef"],["matColumnDef","date"],["mat-cell","",4,"matCellDef"],["matColumnDef","emp_id"],["matColumnDef","fullName"],["matColumnDef","order_status"],["matColumnDef","totalBalance"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"mat-paginator"],[3,"length","pageSizeOptions","pageSize","pageIndex","page"],["dateRangeModal",""],["mat-header-cell",""],["mat-cell","",1,"mat-cell-orderId"],[1,"orderId",3,"click"],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"modal-header","d-flex","align-items-center"],[1,"modal-title"],["aria-hidden","true",1,"fa","fa-times","close",2,"cursor","pointer",3,"click"],[1,"modal-body"],[3,"ngSubmit"],["dateRangeForm","ngForm"],[1,"form-group","m-2"],["for","startDate"],["type","date","id","startDate","name","startDate","required","",1,"form-control",3,"ngModel","ngModelChange","change"],["for","endDate"],["type","date","id","endDate","name","endDate","required","",1,"form-control",3,"ngModel","min","ngModelChange"],["type","submit",1,"btn","btn-outline-primary","w-100","mt-2",3,"disabled"],[1,"pendingOrder-container","pb-4"],[1,"pendingOrder-card"],[1,"container"],[1,"row"],[1,"col-xl-12"],[1,"table-responsive","w-100"],["matColumnDef","itemName"],["mat-cell","","class","mat-cell-order-rec",4,"matCellDef"],["matColumnDef","price"],["matColumnDef","actions"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-cell","",1,"mat-cell-order-rec"],[1,"mat-elevation-z8"],[4,"ngFor","ngForOf"],[1,"order-rec"],["mat-cell","",1,"text-center"],[1,"button-success",3,"click"],[1,"button-danger",3,"click"],[4,"ngIf","ngIfElse"],["orderHistoryTable",""]],template:function(i,r){1&i&&(e.F$t(Ee),e.YNc(0,V,55,9,"section",0),e.YNc(1,be,42,8,"section",1),e.YNc(2,Qe,18,3,"section",0)),2&i&&(e.Q6J("ngIf",r.orderHistory),e.xp6(1),e.Q6J("ngIf",r.pendingOrder),e.xp6(1),e.Q6J("ngIf",r.userorderhistory))},dependencies:[b.sg,b.O5,_._Y,_.YN,_.Kr,_.Fj,_.JJ,_.JL,_.Q7,_.On,_.F,U.NW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,q.YE,P.R],styles:[".searchBar[_ngcontent-%COMP%]{height:40px;display:flex;border:1px solid #787878;border-radius:45px;background-color:#fff;border:2px solid #9122e8}.searchBar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#787878;width:90%;border:none;border-radius:45px;padding:10px;outline:none}.searchBar[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{width:13%;display:flex;align-items:center}.searchBar[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}app-loader[_ngcontent-%COMP%]{display:flex;min-height:600px;position:absolute;width:100%;z-index:3;right:2px;align-items:center;justify-content:center}.dropdown[_ngcontent-%COMP%]{height:80px;display:flex;justify-content:center;align-items:center;margin-right:10px;margin-left:5px;padding:5px}.dropdown-menu[_ngcontent-%COMP%]{min-width:15.375rem;top:100%}.dropdown-toggle[_ngcontent-%COMP%]:after{content:none}.dropdown-item[_ngcontent-%COMP%]:active{background-color:#9122e8}.mat-cell-orderId[_ngcontent-%COMP%]{cursor:pointer}.mat-cell-orderId[_ngcontent-%COMP%]   .orderId[_ngcontent-%COMP%]{display:inline-block;width:35px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.mat-cell-order-rec[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.mat-cell-order-rec[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:50%;text-align:center}.button-success[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;border-radius:10%;background-color:#198754;color:#fff;border:1px solid #198754;margin-right:.5rem;transition:all .3s ease-out;width:100px}.button-success[_ngcontent-%COMP%]:hover{background-color:#fff;color:#198754}.button-danger[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;border-radius:10%;background-color:#dc3545;color:#fff;border:1px solid #dc3545;margin-top:.5rem;margin-right:.5rem;transition:all .3s ease-out;width:100px}.button-danger[_ngcontent-%COMP%]:hover{background-color:#fff;color:#dc3545}.close[_ngcontent-%COMP%]{color:#dc3545;font-size:27px}.modal-title[_ngcontent-%COMP%]{padding-top:19px;font-size:21px}"]})}return n})()}}]);